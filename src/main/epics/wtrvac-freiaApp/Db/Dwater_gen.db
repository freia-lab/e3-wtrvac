# Deionized water cooling system

record(bi, "WtrC-Dwtr:P1:sFault")  {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/150 T=BYTE B=2")
  field(OSV, "MAJOR")
  field(ONAM, "Fault")
  field(ZNAM, "NoFault")
  field(PINI, "YES")
  field(SCAN, "I/O Intr")
}
record(bi, "WtrC-Dwtr:P1:sWarn")  {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/150 T=BYTE B=3")
  field(OSV, "MINOR")
  field(ONAM, "Warning")
  field(ZNAM, "NoWarning")
  field(PINI, "YES")
  field(SCAN, "I/O Intr")
}
record(bi, "WtrC-Dwtr:P1:sAtMinSpeed")  {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/150 T=BYTE B=5")
  field(ONAM, "AtMinSpeed")
  field(PINI, "YES")
  field(SCAN, "I/O Intr")
}
record(bi, "WtrC-Dwtr:P1:sAtMaxSpeed")  {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/150 T=BYTE B=7")
  field(ONAM, "AtMaxSpeed")
  field(PINI, "YES")
  field(SCAN, "I/O Intr")
}
record(bi, "WtrC-Dwtr:P1:sSPinfluenced")  {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/151 T=BYTE B=4")
  field(ONAM, "SP_Influenced")
  field(PINI, "YES")
  field(SCAN, "I/O Intr")
}
record(bi, "WtrC-Dwtr:P1:sRotating")  {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/151 T=BYTE B=6")
  field(ONAM, "Rotating")
  field(ZNAM, "Not_Rotating")
  field(PINI, "YES")
  field(SCAN, "I/O Intr")
  alias("Rotating")
}

record(mbbiDirect, "HPRF-Distr:SwitchBoard:sSwitch") {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/504 T=WORD")
  field (NOBT, "16")
  field (SHFT, "0")
  field(PINI, "YES")
  field(SCAN, "I/O Intr")
}


record(ai, "WtrC-Dwtr:P1:sWarnCode")  {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/158 T=BYTE")
  field(PINI, "YES")
  field(SCAN, "I/O Intr")
}
record(ai, "WtrC-Dwtr:P1:sFaultCode")  {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/159 T=BYTE")
  field(PINI, "YES")
  field(SCAN, "I/O Intr")
}

# Input/output records

record(mbbi, "WtrC-Dwtr:P1:sOpMode") {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/157 T=BYTE")
  field(NOBT, "8")
  field(ZRVL, "0")
  field(ZRST, "AutoControl")
  field(ONVL, "4")
  field(ONST, "OpenLoopMin")
  field(TWVL, "6")
  field(TWST, "OpenLoopMax")
  field(PINI, "YES")
  field(FLNK, "WtrC-Dwtr:P1:cOpMode-rbk")
  field(SCAN, "I/O Intr")
}

record(calcout, "WtrC-Dwtr:P1:cOpMode-rbk") {
  field(INPA, "WtrC-Dwtr:P1:sOpMode")
  field(CALC, "A")
  field(SCAN, "Event")
  field(EVNT, "$(INIT_EVNT)")
  field(OUT, "WtrC-Dwtr:P1:cOpMode PP")
}

record(mbbo, "WtrC-Dwtr:P1:cOpMode") {
  field(DTYP, "S7plc")
  field(OUT, "@PLC:WTRVAC/34 T=BYTE")
  field(NOBT, "8")
  field(ZRVL, "0")
  field(ZRST, "AutoControl")
  field(ONVL, "4")
  field(ONST, "OpenLoopMin")
  field(TWVL, "6")
  field(TWST, "OpenLoopMax")
  field(PINI, "NO")
}



record(ai, "WtrC-Dwtr:P1:sSetPoint") {
  field(DTYP, "S7plc")
  field(INP, "@PLC:WTRVAC/214 T=FLOAT")
  field(PREC, 1)
  field(EGU, "%")
  field(LOPR, "0")
  field(HOPR, "100")
  field(PINI, "YES")
  field(FLNK, "WtrC-Dwtr:P1:cSetPoint-rbk")
  field(SCAN, "I/O Intr")
}

record(calcout, "WtrC-Dwtr:P1:cSetPoint-rbk") {
  field(INPA, "WtrC-Dwtr:P1:sSetPoint")
  field(CALC, "A")
  field(SCAN, "Event")
  field(EVNT, "$(INIT_EVNT)")
  field(OUT, "WtrC-Dwtr:P1:cSetPoint PP")
}

record(ao, "WtrC-Dwtr:P1:cSetPoint") {
  field(DTYP, "S7plc")
  field(OUT, "@PLC:WTRVAC/36 T=FLOAT")
  field(PREC, 1)
  field(EGU, "%")
  field(LOPR, "0")
  field(HOPR, "100")
  field(PINI, "NO")
}


# Output records

record(bo, "WtrC-Dwtr:P1:cmdReset") {
  field(DTYP, "S7plc")
  field(OUT, "@PLC:WTRVAC/32 T=BYTE B=2")
  field(ZNAM, "Iddle")
  field(ONAM, "Reset")
  field(PINI, "NO")
  field(HIGH, "0.5")
}

